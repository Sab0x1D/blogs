---
layout: default
---

{%- comment -%}
This layout renders ONLY the 9-card archive grid for page N (N >= 2).
It mirrors index.html logic: exclude the Hero (latest) and the first 4 Featured,
then slice 9 posts based on page.page_num. The wrapper id MUST be #posts-grid.
{%- endcomment -%}

<link rel="stylesheet" href="{{ '/assets/css/theme.css' | relative_url }}">
<link rel="stylesheet" href="{{ '/assets/css/site.css'  | relative_url }}">

<section class="home">
  <div class="container">
    {%- assign coll = site.listings | sort: 'date' | reverse -%}
    {%- assign excerpt_limit = site.excerpt_chars | default: 220 -%}

    {%- assign hero = coll | first -%}

    {%- comment -%} Build exclusions identical to index.html {%- endcomment -%}
    {%- assign featured_list = coll | where_exp: 'p', 'p.featured == true' | slice: 0, 4 -%}
    {%- assign featured_urls = featured_list | map: 'url' -%}

    {%- assign previous = "" | split: "" -%}
    {%- for p in coll -%}
      {%- unless featured_urls contains p.url or p.url == hero.url -%}
        {%- assign previous = previous | push: p -%}
      {%- endunless -%}
    {%- endfor -%}

    {%- assign page_size = 9 -%}
    {%- assign current   = page.page_num | plus: 0 -%}
    {%- if current <= 1 %}{% assign current = 2 %}{% endif %} {# safety: paged starts at 2 #}
    {%- assign offset = page_size | times: current | minus: page_size -%}

    <!-- IMPORTANT: this exact id is fetched by load-more.js -->
    <section id="posts-grid" class="grid" aria-label="Previous posts">
      {%- for p in previous offset: offset limit: page_size -%}
        <a class="card card--lg" href="{{ p.url | relative_url }}">
          <div class="media">
            <img class="thumb" src="{{ (p.thumb | default: site.default_thumb) | relative_url }}" alt="{{ p.title }}">
            <span class="meta-top">{{ p.date | date: "%d %b %Y" }}</span>
          </div>
          <div class="body">
            <h3 class="title">{{ p.title }}</h3>
            {%- if p.excerpt -%}
              <p class="excerpt">{{ p.excerpt | strip_html | truncate: excerpt_limit }}"></p>
            {%- endif -%}
          </div>
        </a>
      {%- endfor -%}
    </section>

    {# No hero, no featured, no pager, no button here #}
  </div>
</section>
