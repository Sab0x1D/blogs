---
layout: default
title: "ghostYara"
permalink: /ghostyara/
---

<!--
Data-driven YARA catalog
- Put your rules in _data/yara_rules.yml (recommended) with this schema:

- id: trojan_qakbot_001
  name: "QakBot: Packed Loader"
  family: "QakBot"
  tags: ["banker","loader","malspam"]
  author: "Sab0x1D"
  last_updated: "2025-10-31"
  tlp: "CLEAR"
  threat_refs:
    - "https://example.com/report"
  rule: |
    rule QakBot_Packed_Loader { meta: author="Sab0x1D" date="2025-10-31"
      strings: $a = { 4D 5A 90 00 ?? ?? } condition: uint16(0) == 0x5A4D and $a
    }

If _data/yara_rules.* is missing, the page will show a helpful empty state.
-->

<section style="max-width:var(--container);margin:0 auto;padding:var(--gap);">
  <header style="display:flex;flex-direction:column;gap:10px;margin-bottom:8px;">
    <h1 style="margin:0;">ghostYara</h1>
    <p style="color:var(--muted);margin:0;">Curated YARA rules by family and tags. Fast filter + copy.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap;">
      <input id="gy-search" type="search" placeholder="Search name, family, tags..."
             style="flex:1;min-width:240px;padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;">
      <select id="gy-family" aria-label="Filter by family"
              style="padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;background:var(--card);">
        <option value="">All families</option>
        {% assign families = site.data.yara_rules | map: "family" | uniq | sort %}
        {% for fam in families %}
          {% if fam %}<option value="{{ fam | escape }}">{{ fam }}</option>{% endif %}
        {% endfor %}
      </select>
      <select id="gy-tag" aria-label="Filter by tag"
              style="padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;background:var(--card);">
        <option value="">All tags</option>
        {% assign all_tags = "" | split: "" %}
        {% for r in site.data.yara_rules %}
          {% if r.tags %}{% assign all_tags = all_tags | concat: r.tags %}{% endif %}
        {% endfor %}
        {% assign tagset = all_tags | uniq | sort %}
        {% for t in tagset %}
          {% if t %}<option value="{{ t | escape }}">{{ t }}</option>{% endif %}
        {% endfor %}
      </select>
      <button id="gy-clear" type="button"
              style="padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;background:var(--chip-bg);cursor:pointer;">
        Clear
      </button>
    </div>
  </header>

  {% assign rules = site.data.yara_rules %}
  {% if rules and rules.size > 0 %}
    <div id="gy-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:var(--gap);">
      {% for r in rules %}
      <article class="card gy-item"
               data-name="{{ r.name | downcase }}"
               data-family="{{ r.family | downcase }}"
               data-tags="{% if r.tags %}{{ r.tags | join: ',' | downcase }}{% endif %}"
               style="background:var(--card);border:1px solid var(--card-border);border-radius:var(--round);overflow:hidden;display:flex;flex-direction:column;">
        <div style="padding:16px 16px 0 16px;">
          <div style="display:flex;justify-content:space-between;gap:8px;align-items:center;">
            <h2 style="margin:0;font-size:1.05rem;line-height:1.3;">{{ r.name }}</h2>
            <span style="font-size:.78rem;color:var(--muted-2);">{{ r.tlp | default: "TLP:CLEAR" }}</span>
          </div>
          <p style="margin:8px 0 10px 0;color:var(--muted);">
            <strong>Family:</strong> {{ r.family | default: "—" }}
            {% if r.tags and r.tags.size > 0 %}
              · <strong>Tags:</strong>
              {% for t in r.tags %}
                <span style="border:1px solid var(--card-border);border-radius:999px;padding:2px 8px;margin-left:4px;background:var(--chip-bg);">{{ t }}</span>
              {% endfor %}
            {% endif %}
          </p>
          <p style="margin:0 0 12px 0;color:var(--muted-2);font-size:.9rem;">
            {% if r.author %}By {{ r.author }}{% endif %}
            {% if r.last_updated %} · Updated {{ r.last_updated }}{% endif %}
          </p>
        </div>

        <pre style="margin:0;padding:12px 16px;background:#0b0f1910;overflow:auto;max-height:320px;"><code>{{ r.rule | escape }}</code></pre>

        <div style="display:flex;gap:8px;padding:12px 16px;border-top:1px solid var(--card-border);align-items:center;flex-wrap:wrap;">
          <button class="gy-copy"
                  data-copy="{{ r.rule | strip_newlines | escape }}"
                  type="button"
                  style="padding:8px 10px;border:1px solid var(--card-border);border-radius:10px;background:var(--card);cursor:pointer;">
            Copy rule
          </button>
          {% if r.threat_refs %}
            {% for ref in r.threat_refs %}
              <a href="{{ ref }}" target="_blank" rel="noopener"
                 style="padding:8px 10px;border:1px solid var(--card-border);border-radius:10px;text-decoration:none;color:var(--text);background:var(--chip-bg);">
                Ref {{ forloop.index }}
              </a>
            {% endfor %}
          {% endif %}
          {% if r.id %}
            <span style="margin-left:auto;color:var(--muted-2);font-size:.8rem;">ID: {{ r.id }}</span>
          {% endif %}
        </div>
      </article>
      {% endfor %}
    </div>
  {% else %}
    <div style="margin-top:16px;padding:16px;border:1px dashed var(--card-border);border-radius:var(--round);background:var(--chip-bg);">
      <p style="margin:0 0 6px 0;"><strong>No YARA rules found.</strong></p>
      <p style="margin:0;color:var(--muted);">Create <code>_data/yara_rules.yml</code> using the schema in the comment at the top of this page, then rebuild.</p>
      <details style="margin-top:10px;">
        <summary style="cursor:pointer;">See sample</summary>
<pre style="margin:10px 0 0 0;padding:12px;background:#0b0f1910;border-radius:10px;overflow:auto;"><code>- id: trojan_sample_001
  name: "Sample: Suspicious MZ header"
  family: "Generic"
  tags: ["mz","pe","suspicious"]
  author: "Sab0x1D"
  last_updated: "2025-10-31"
  tlp: "CLEAR"
  threat_refs:
    - "https://example.com/report"
  rule: |
    rule Suspicious_MZ_Header {
      meta:
        author = "Sab0x1D"
        date = "2025-10-31"
      strings:
        $mz = { 4D 5A }
      condition:
        uint16(0) == 0x5A4D and $mz
    }</code></pre>
      </details>
    </div>
  {% endif %}
</section>

<script>
(function(){
  const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));
  const q = document.getElementById('gy-search');
  const fam = document.getElementById('gy-family');
  const tag = document.getElementById('gy-tag');
  const clearBtn = document.getElementById('gy-clear');
  const items = $$('.gy-item');

  function norm(x){ return (x||'').toLowerCase().trim(); }

  function applyFilters(){
    const qv = norm(q.value);
    const fv = norm(fam.value);
    const tv = norm(tag.value);

    let shown = 0;
    items.forEach(it=>{
      const name = it.dataset.name || '';
      const family = it.dataset.family || '';
      const tags = it.dataset.tags || '';
      const matchesQ = !qv || (name.includes(qv) || family.includes(qv) || tags.includes(qv));
      const matchesF = !fv || family === fv;
      const matchesT = !tv || tags.split(',').includes(tv);
      const ok = matchesQ && matchesF && matchesT;
      it.style.display = ok ? '' : 'none';
      if(ok) shown++;
    });
  }

  [q, fam, tag].forEach(el=>el && el.addEventListener('input', applyFilters));
  clearBtn && clearBtn.addEventListener('click', ()=>{
    if(q) q.value = '';
    if(fam) fam.value = '';
    if(tag) tag.value = '';
    applyFilters();
  });

  // Copy buttons
  $$('.gy-copy').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const txt = btn.getAttribute('data-copy') || '';
      try{
        await navigator.clipboard.writeText(txt.replaceAll('\\n','\n'));
        const old = btn.textContent;
        btn.textContent = 'Copied ✓';
        setTimeout(()=>btn.textContent = old, 1200);
      }catch(e){
        btn.textContent = 'Copy failed';
        setTimeout(()=>btn.textContent = 'Copy rule', 1200);
      }
    });
  });

  applyFilters();
})();
</script>
