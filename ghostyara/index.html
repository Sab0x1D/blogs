---
layout: default
title: "ghostYara"
permalink: /ghostyara/
---

<style>
  /* ghostYara layout fixes */
  .gy-item p { word-break: break-word; }
  .gy-item p strong { white-space: nowrap; }
  .gy-item p strong + span { margin-left: 4px; }
  .gy-item p span { display: inline-block; margin-top: 4px; }

  .gy-item { display:flex; flex-direction:column; }
  .gy-item pre { flex-grow:1; }
  .gy-item > div:last-of-type{
    margin-top:auto;
    border-top:1px solid var(--card-border);
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    align-items:center;
    padding:12px 16px;
  }
  .gy-item > div:last-of-type span:last-child{
    margin-left:auto;
    color:var(--muted-2);
    font-size:.8rem;
  }
  /* Space between search/filter bar and grid */
  #gy-grid { margin-top: 28px; }
</style>

<section style="max-width:var(--container);margin:0 auto;padding:var(--gap);">
  <header style="display:flex;flex-direction:column;gap:10px;margin-bottom:8px;">
    <h1 style="margin:0;">ghostYara</h1>
    <p style="color:var(--muted);margin:0;">Curated YARA rules by family and tags. Fast filter + copy.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap;">
      <input id="gy-search" type="search" placeholder="Search name, family, tags..."
             style="flex:1;min-width:240px;padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;">
      <select id="gy-family" aria-label="Filter by family"
              style="padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;background:var(--card);">
        <option value="">All families</option>
        {% assign families = site.data.yara_rules | map: "family" | uniq | sort %}
        {% for fam in families %}
          {% if fam %}<option value="{{ fam | escape }}">{{ fam }}</option>{% endif %}
        {% endfor %}
      </select>
      <select id="gy-tag" aria-label="Filter by tag"
              style="padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;background:var(--card);">
        <option value="">All tags</option>
        {% assign all_tags = "" | split: "" %}
        {% for r in site.data.yara_rules %}
          {% if r.tags %}{% assign all_tags = all_tags | concat: r.tags %}{% endif %}
        {% endfor %}
        {% assign tagset = all_tags | uniq | sort %}
        {% for t in tagset %}
          {% if t %}<option value="{{ t | escape }}">{{ t }}</option>{% endif %}
        {% endfor %}
      </select>
      <button id="gy-clear" type="button"
              style="padding:10px 12px;border:1px solid var(--card-border);border-radius:12px;background:var(--chip-bg);cursor:pointer;">
        Clear
      </button>
    </div>
  </header>

  {% assign rules = site.data.yara_rules %}
  {% if rules and rules.size > 0 %}
    <div id="gy-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:var(--gap);">
      {% for r in rules %}
      <article class="card gy-item"
               data-name="{{ r.name | downcase }}"
               data-family="{{ r.family | downcase }}"
               data-tags="{% if r.tags %}{{ r.tags | join: ',' | downcase }}{% endif %}"
               style="background:var(--card);border:1px solid var(--card-border);border-radius:var(--round);overflow:hidden;">
        <div style="padding:16px 16px 0 16px;">
          <div style="display:flex;justify-content:space-between;gap:8px;align-items:center;">
            <h2 style="margin:0;font-size:1.05rem;line-height:1.3;">{{ r.name }}</h2>
            <span style="font-size:.78rem;color:var(--muted-2);">{{ r.tlp | default: "TLP:CLEAR" }}</span>
          </div>
          <p style="margin:8px 0 10px 0;color:var(--muted);">
            <strong>Family:</strong> {{ r.family | default: "—" }}
            {% if r.tags and r.tags.size > 0 %}
              · <strong>Tags:</strong>
              {% for t in r.tags %}
                <span style="border:1px solid var(--card-border);border-radius:999px;padding:2px 8px;margin-left:4px;background:var(--chip-bg);">{{ t }}</span>
              {% endfor %}
            {% endif %}
          </p>
          <p style="margin:0 0 12px 0;color:var(--muted-2);font-size:.9rem;">
            {% if r.author %}By {{ r.author }}{% endif %}
            {% if r.last_updated %} · Updated {{ r.last_updated }}{% endif %}
          </p>
        </div>

        <pre style="margin:0;padding:12px 16px;background:#0b0f1910;overflow:auto;max-height:320px;"><code>{{ r.rule | escape }}</code></pre>

        <div>
          <button class="gy-copy"
                  data-copy="{{ r.rule | strip_newlines | escape }}"
                  type="button"
                  style="padding:8px 10px;border:1px solid var(--card-border);border-radius:10px;background:var(--card);cursor:pointer;">
            Copy rule
          </button>
          {% if r.id %}
            <span>ID: {{ r.id }}</span>
          {% endif %}
        </div>
      </article>
      {% endfor %}
    </div>
  {% else %}
    <div style="margin-top:16px;padding:16px;border:1px dashed var(--card-border);border-radius:var(--round);background:var(--chip-bg);">
      <p style="margin:0 0 6px 0;"><strong>No YARA rules found.</strong></p>
      <p style="margin:0;color:var(--muted);">Create <code>_data/yara_rules.yml</code> and rebuild.</p>
    </div>
  {% endif %}
</section>

<script>
(function(){
  const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));
  const q=document.getElementById('gy-search'),
        fam=document.getElementById('gy-family'),
        tag=document.getElementById('gy-tag'),
        clear=document.getElementById('gy-clear'),
        items=$$('.gy-item');

  const norm=x=>(x||'').toLowerCase().trim();

  function apply(){
    const qv=norm(q.value), fv=norm(fam.value), tv=norm(tag.value);
    items.forEach(it=>{
      const name=it.dataset.name||'', f=it.dataset.family||'', t=it.dataset.tags||'';
      const ok=(!qv||(name.includes(qv)||f.includes(qv)||t.includes(qv))) &&
               (!fv||f===fv) &&
               (!tv||t.split(',').includes(tv));
      it.style.display=ok?'':'none';
    });
  }
  [q,fam,tag].forEach(el=>el&&el.addEventListener('input',apply));
  clear&&clear.addEventListener('click',()=>{q.value='';fam.value='';tag.value='';apply();});

  $$('.gy-copy').forEach(btn=>{
    btn.addEventListener('click',async()=>{
      const txt=btn.getAttribute('data-copy')||'';
      try{
        await navigator.clipboard.writeText(txt.replaceAll('\\n','\n'));
        const old=btn.textContent;
        btn.textContent='Copied ✓';
        setTimeout(()=>btn.textContent=old,1200);
      }catch(e){
        btn.textContent='Copy failed';
        setTimeout(()=>btn.textContent='Copy rule',1200);
      }
    });
  });

  apply();
})();
</script>
