---
layout: default
title: Blog
page_num: 1
permalink: /
---

<link rel="stylesheet" href="{{ '/assets/theme.css' | relative_url }}">
<link rel="stylesheet" href="{{ '/assets/site.css' | relative_url }}">
<script defer src="{{ '/assets/theme.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/site.js'  | relative_url }}"></script>

<section class="home">
  {% assign coll = site.listings | sort: "date" | reverse %}

  {% assign curated = coll | where_exp: "p", "p.featured == true" %}
  {% assign featured = curated %}
  {% if featured.size == 0 %}{% assign featured = coll %}{% endif %}

  <h2 class="section-title">Featured</h2>
  <div class="featured-row">
    {% assign count = 0 %}
    {% capture f_urls %}{% endcapture %}
    {% for p in featured limit:4 %}
      {% include card.html doc=p variant="sm" %}
      {% capture f_urls %}{{ f_urls }}|{{ p.url }}|{% endcapture %}
      {% assign count = count | plus: 1 %}
    {% endfor %}
  </div>

  {% assign page_size = 6 %}
  {% assign offset = page.page_num | minus: 1 | times: page_size %}

  {% assign previous = "" | split: "," %}
  {% for p in coll %}
    {% unless f_urls contains p.url %}
      {% assign previous = previous | push: p %}
    {% endunless %}
  {% endfor %}

  {% assign total_pages = previous.size | divided_by: page_size %}
  {% if previous.size > page_size %}{% assign total_pages = previous.size | plus: page_size | minus: 1 | divided_by: page_size %}{% endif %}

  <h2 class="section-title">Previous posts</h2>
  <div class="grid">
    {% for p in previous limit: page_size offset: offset %}
      {% include card.html doc=p variant="lg" %}
    {% endfor %}
  </div>

  {% include pagination.html page_num=page.page_num total_pages=total_pages %}

  <h2 class="section-title">Popular topics</h2>
  {% assign topics = site.popular_topics | default: "Malware,Phish,Scam" | split: "," %}
  <div class="chips">
    {% for t in topics %}
      {% assign t_clean = t | strip %}
      <button class="chip" data-topic="{{ t_clean }}">{{ t_clean }}</button>
    {% endfor %}
  </div>
</section>
